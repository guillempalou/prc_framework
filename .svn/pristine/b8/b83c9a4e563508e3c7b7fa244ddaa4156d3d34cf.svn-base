// --------------------------------------------------------------
// Copyright (C)
// Universitat Politecnica de Catalunya (UPC) - Barcelona - Spain
// --------------------------------------------------------------

/*!
 * \file hungarian.test
 */ 

#include <imageplus/core.hpp>
#include <imageplus/math/graphs/hungarian.hpp>
#include <imageplus/io/readimage.hpp>

BOOST_AUTO_TEST_SUITE ( Math_Graph_Hungarian_Suite );

using namespace imageplus;
using namespace math::graphs;
using namespace std;

BOOST_AUTO_TEST_CASE( Hungarian_algorithm_test)
{  
    MultiArray<float32,2> cost(4,4);
    cost[0][0] = -4.1; cost[0][1] =  0; cost[0][2] =  0; cost[0][3] = 0;
    cost[1][0] =  0;   cost[1][1] =  0; cost[1][2] = -4; cost[1][3] = 0;
    cost[2][0] = -2;   cost[2][1] = -2; cost[2][2] =  0; cost[2][3] = 0;
    cost[3][0] =  0;   cost[3][1] =  0; cost[3][2] = -4; cost[3][3] = 0;
    
    std::vector<int32> row;
    std::vector<int32> col;
    BOOST_CHECK_EQUAL(hungarian(cost, row, col), (float32)-10.1);
    
    BOOST_CHECK_EQUAL(row[0], 0);
    BOOST_CHECK_EQUAL(row[1], 2);
    BOOST_CHECK_EQUAL(row[2], 1);
    BOOST_CHECK_EQUAL(row[3], 3);

    BOOST_CHECK_EQUAL(col[0], 0);
    BOOST_CHECK_EQUAL(col[1], 2);
    BOOST_CHECK_EQUAL(col[2], 1);
    BOOST_CHECK_EQUAL(col[3], 3);
}


BOOST_AUTO_TEST_SUITE_END ();

