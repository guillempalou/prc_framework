// --------------------------------------------------------------
// Copyright (C)
// Universitat Politecnica de Catalunya (UPC) - Barcelona - Spain
// --------------------------------------------------------------

//!
//!  \file distance_transform.test
//!

#include <imageplus/core/imavolmask.hpp>
#include <imageplus/core/imagergb.hpp>
#include <imageplus/core/imagegray.hpp>
#include <imageplus/math/transforms/distance_transform.hpp>


BOOST_AUTO_TEST_SUITE ( distance_transform_suite );

using namespace imageplus;
using namespace imageplus::math::transforms;



BOOST_AUTO_TEST_CASE( distance_transform_compute )
{
    ImageMask im_mask(5,5);
    ImageRGB<uint8> image_rgb(5,5);
    
    im_mask[1][1] = true; im_mask[1][2] = true; im_mask[1][3] = true; im_mask[2][3] = true;

    ImageGray<uint16> ground_truth(5,5);
    ground_truth[0][0] = 2; ground_truth[0][1] = 1; ground_truth[0][2] = 1; ground_truth[0][3] = 1; ground_truth[0][4] = 2;
    ground_truth[1][0] = 1; ground_truth[1][1] = 0; ground_truth[1][2] = 0; ground_truth[1][3] = 0; ground_truth[1][4] = 1;
    ground_truth[2][0] = 2; ground_truth[2][1] = 1; ground_truth[2][2] = 1; ground_truth[2][3] = 0; ground_truth[2][4] = 1;
    ground_truth[3][0] = 3; ground_truth[3][1] = 2; ground_truth[3][2] = 2; ground_truth[3][3] = 1; ground_truth[3][4] = 2;
    ground_truth[4][0] = 4; ground_truth[4][1] = 3; ground_truth[4][2] = 3; ground_truth[4][3] = 2; ground_truth[4][4] = 3;
    
    DistanceTransform& dist_transf = calc_descriptor(new DistanceTransform(), image_rgb, im_mask);
    BOOST_CHECK(ground_truth(0)==dist_transf(0));
}


BOOST_AUTO_TEST_SUITE_END ();
