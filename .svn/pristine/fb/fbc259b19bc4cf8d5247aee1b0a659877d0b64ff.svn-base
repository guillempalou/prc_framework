// --------------------------------------------------------------
// Copyright (C)
// Universitat Politecnica de Catalunya (UPC) - Barcelona - Spain
// --------------------------------------------------------------

//!
//! \file closing3d.test
//!
//! Tests for class Closing
//!

#include <iostream>

#include <imageplus/core.hpp>
#include <imageplus/io/readvolume.hpp>
#include <imageplus/io/writevolume.hpp>
#include <imageplus/math/morphology/closing.hpp>

BOOST_AUTO_TEST_SUITE ( Closing3dSuite );

using namespace std;
using namespace imageplus;
using namespace imageplus::io;
using namespace imageplus::math::morphology;

typedef boost::mpl::list<uint8,int64,float64> DataTypes;


BOOST_AUTO_TEST_CASE( Closing3dGeneral)
{
    ReadVolume rvol (string(TEST_DATA_PATH_R) +"/volume_toy2.rle");
    VolumeGray<uint8> vol;
    Closing<3> closing(26,3);

    rvol >> vol;

    VolumeGray<uint8> out(vol);

    out=closing.filter(vol);

    for(uint32 k=5; k<6; k++)
    {
        for (uint32 j=6; j<8; j++)
        {
            for (uint32 i=4; i<5; i++)
            {
                    BOOST_CHECK_EQUAL(vol(0)[i][j][k],out(0)[i][j][k]);
            }
        }
    }
}

BOOST_AUTO_TEST_SUITE_END ();
