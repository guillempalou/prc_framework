// --------------------------------------------------------------
// Copyright (C)
// Universitat Politecnica de Catalunya (UPC) - Barcelona - Spain
// --------------------------------------------------------------

//!
//!  \file writeroom.hpp
//!
//!  Interface for the WriteRoom class, base class all writing operations involving room files
//!  (volume data and additional information relating samples with real world)
//!
#ifndef IMAGEPLUS_IO_WRITEROOM_HPP
#define IMAGEPLUS_IO_WRITEROOM_HPP

#include <string>

#include <imageplus/core.hpp>
#include <imageplus/io/readroom.hpp>
#include <imageplus/compress/rle.hpp>

namespace imageplus
{

    namespace io
    {
        //!
        //! \brief Base class for Room File Writing
        //!
        //! \author Adolfo LÃ³pez <alopez@gps.tsc.upc.es>
        //! \author Cristian Canton <ccanton@gps.tsc.upc.es>
        //! \author Josep Ramon Casas <josep@gps.tsc.upc.es>
        //!
        //! \date 14-01-2008
        //!
        //! WriteRoom performs the equivalent functionalities of classical output volume files
        //! management.
        //! WriteRoom allows writing files either in normal byte format or X3D format.
        //! The operator << performs a file extension check to determine the output format.
        //!
        //! The following example shows how to use WriteVolume class
        //! \code
        //! RoomGray room;
        //! WriteRoom writer("output_file.rle");
        //! writer << room;
        //! writer.open("output_file.x3d");
        //! writer << room;
        //! \endcode
        //!
        //! When the file has rle extension, the operator writes the byte volume with the RLE compressor.
        //! By method open we can change the destination format which implicitly changes the operator
        //! functionality.
        //!
        //! X3D writer code is based on Josep's SoftImage branch version and it has been coded to represent volumetric
        //! shapes in a UPC Smart Room Appearance model with the size of the given room class.
        //!
        class WriteRoom
        {

            public:
                //!
                //! \brief Default constructor. Creates a WriteRoom class with empty output file
                //!
                explicit WriteRoom();
                //!
                //! \brief Constructor. Creates WriteRoom with a specific output file
                //!
                //! \param[in] filename: the name of the file to write to 
                //!
                explicit WriteRoom( const std::string& filename );
                //!
                //! \brief Destructor
                //!
                ~WriteRoom();
                //!
                //! \brief Check and change of the output file
                //!
                //! \param[in] filename: the name of the file to write to
                //!
                void open( const std::string& filename );
                //!
                //! \brief Operator << for WriteRoom class. Writes an RGB Volume within a room class in the file determined
                //! by the constructor or open method. The volume is written in rle or in x3d format depending
                //! on the file extension.
                //!
                //! param[in] RoomRGB: Room with Color Volume to be written
                //!
                template<typename T>
                void operator<<( const Room<T,3>&) const;
                //!
                //! \brief Operator << for WriteRoom class. Writes a Gray Volume in the file determined
                //! by the constructor or open method. The volume is written in rle or in x3d format depending
                //! on the file extension.
                //!
                //! param[in] RoomGray: Room with Grayscale Volume to be written
                //!
                template<typename T>
                void operator<<(const Room<T,1>&) const;

            private:
                //!
                //! \brief Forbidden copy Constructor
                //!
                //! \param[in] cpy: WriteRoom to copy from
                //!
                WriteRoom( const WriteRoom& cpy );

                //!
                //! \brief Forbidden assignment operator for WriteRoom class.
                //!
                //! \param[in] cpy: object to be assigned
                //!
                //! \return cpy, just to concatenate
                //!
                const WriteRoom& operator=( const WriteRoom& cpy );

                //! string storing the file route
                std::string _filename;
        };
    } // namespace io
} //namespace imageplus
#endif /*WRITEROOM_HPP_*/
