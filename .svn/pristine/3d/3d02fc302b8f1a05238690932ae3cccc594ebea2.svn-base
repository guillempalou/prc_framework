// --------------------------------------------------------------
// Copyright (C)
// Universitat Politecnica de Catalunya (UPC) - Barcelona - Spain
// --------------------------------------------------------------

//!
//!  \file quadratic_function.test
//!
//!  Tests for the math operations on BBox classs 
//!

#include <imageplus/math/numeric/quadratic_function.hpp>
#include <cmath>

BOOST_AUTO_TEST_SUITE ( quadratic_function );

using namespace imageplus;
using namespace imageplus::math;
using namespace imageplus::math::numeric;


BOOST_AUTO_TEST_CASE ( test_quadratic_function )
{
	uint64 D = 3;
	
	Matrix A = Matrix::Random(D,D);
	Vector b = Vector::Random(D);
	Vector c = Vector::Random(D);
	
	QuadraticFunction q(A,b,c);
	
	for (uint64 i = 0; i < 10; i++) {
		Vector x = Vector::Random(D);
		
		Vector result = 0.5*x.transpose()*A*x - b.transpose()*x + c;
		float64 value = q.value(x);

		BOOST_CHECK_CLOSE(result(0),value, 1e-6);
	}
}

BOOST_AUTO_TEST_SUITE_END ();
