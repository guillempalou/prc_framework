// --------------------------------------------------------------
// Copyright (C)
// Universitat Politecnica de Catalunya (UPC) - Barcelona - Spain
// --------------------------------------------------------------

//!
//!  \file quadratic_function.test
//!
//!  Tests for the math operations on BBox classs
//!

#include <imageplus/math/optimization/full_search.hpp>

BOOST_AUTO_TEST_SUITE ( test_full_search );

using namespace imageplus;
using namespace imageplus::math;
using namespace imageplus::math::optimization;

class DifficultFunction : public numeric::ScalarFunction {
public:

	DifficultFunction() : numeric::ScalarFunction(2) {

	}

	inline const float64 value(const Vector& x) {
		return 100*(x(1) - x(0)*x(0))*(x(1) - x(0)*x(0)) + (1-x(0))*(1-x(0));
	}
};

BOOST_AUTO_TEST_CASE( full_search_test )
{
	DifficultFunction f;
	FullSearchMinimizer nm(f);

	Vector lower_point(2);
	lower_point << 0,
					 0;

	Vector upper_point(2);
	upper_point << 2,
					2;

	nm.minimize(lower_point, upper_point);

	Vector solution(2);
	solution << 1,
				1;

	Vector minimum_point = nm.minimum_point();

	BOOST_CHECK((minimum_point-solution).norm() < 1e-3);
}

BOOST_AUTO_TEST_SUITE_END ();
