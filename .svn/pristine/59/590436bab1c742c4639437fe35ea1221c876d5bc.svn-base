// --------------------------------------------------------------
// Copyright (C)
// Universitat Politecnica de Catalunya (UPC) - Barcelona - Spain
// --------------------------------------------------------------


#define IMAGEPLUS_TOOL_CONFIG_NAME  bay2img
#define IMAGEPLUS_TOOL_CONFIG_GROUP converters

#include <imageplus/toolbox/tool_config.hpp>


#include <imageplus/core.hpp>
#include <imageplus/io/readimage.hpp>
#include <imageplus/io/writeimage.hpp>

#include <iostream>


using namespace std;
using namespace imageplus;

IMAGEPLUS_TOOL_CONFIG_BRIEF()

    "Conversion from a bayer file (.bay) to a an image file (.png, .tiff, .jpg...)";


IMAGEPLUS_TOOL_CONFIG_DESCRIPTION()

    "Conversion from a bayer file (.bay) to a an image file (.png, .tiff, .jpg...)";


IMAGEPLUS_TOOL_CONFIG_PARAMETERS()

    // arguments
    string bay_file;
    string img_file;


IMAGEPLUS_TOOL_CONFIG_DEFAULT_VALUES()


IMAGEPLUS_TOOL_CONFIG_OPTIONS()


IMAGEPLUS_TOOL_CONFIG_FLAGS()


IMAGEPLUS_TOOL_CONFIG_ARGUMENTS()

    // add arguments in the desired order
    IMAGEPLUS_TOOL_CONFIG_ARGUMENT( bay_file , "Input bayer file (.bay)" );
    IMAGEPLUS_TOOL_CONFIG_ARGUMENT( img_file , "Output image file" );


IMAGEPLUS_TOOL_CONFIG_READ_PARAMETERS()

    IMAGEPLUS_TOOL_CONFIG_READ( bay_file );
    IMAGEPLUS_TOOL_CONFIG_READ( img_file );

IMAGEPLUS_TOOL_CONFIG_MAIN()
{
    io::ReadImage  rimg( cfg.bay_file );
    io::WriteImage wimg( cfg.img_file );
    
    //MultiArray<uint8,2> bay;
    ImageRGB<uint8>     rgb;
    
    rimg >> rgb;
    wimg << rgb;

    return 0;
}


//
// This last line is mandatory!
//
IMAGEPLUS_TOOL_CONFIG_END()
