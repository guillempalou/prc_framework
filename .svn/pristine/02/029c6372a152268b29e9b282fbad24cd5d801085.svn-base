// --------------------------------------------------------------
// Copyright (C)
// Universitat Politecnica de Catalunya (UPC) - Barcelona - Spain
// --------------------------------------------------------------

/*!
 * \file false_color.test
 */ 

#include <imageplus/segmentation/false_color.hpp>
#include <imageplus/io/readimage.hpp>
#include <imageplus/io/writeimage.hpp>
#include <imageplus/math/statistics/multiarray_statistics.hpp>

BOOST_AUTO_TEST_SUITE ( Segmentation_FalseColor_Suite );

using namespace imageplus;
using namespace segmentation;

namespace ims = imageplus::math::statistics;


BOOST_AUTO_TEST_CASE( false_color_test )
{

    io::ReadImage read_partition( std::string(TEST_DATA_PATH_R) + "/segmentation/reference.prl");
    ImagePartition<uint32> part;
    read_partition >> part;

    relabel(part, part);
    MultiArray<uint8,2> lut(3, ims::maxval(part(0))+1);

    // imageplus::random (lut, static_cast<uint8>(255));
    lut[0][0] = 155; lut[1][0] =  64; lut[2][0] =  32;  
    lut[0][1] =  73; lut[1][1] = 138; lut[2][1] = 242;  
    lut[0][2] = 221; lut[1][2] =   4; lut[2][2] =  62;
    lut[0][3] = 178; lut[1][3] = 188; lut[2][3] =  86;
    lut[0][4] =  60; lut[1][4] = 218; lut[2][4] = 130;  
    lut[0][5] = 167; lut[1][5] =  92; lut[2][5] = 245;  

    ImageRGB<uint8> out = false_color(part, lut);

    io::ReadImage read_img( std::string(TEST_DATA_PATH_R) + "/segmentation/reference_false.png");
    ImageRGB<uint8> false_color_img;
    read_img >> false_color_img;

    BOOST_CHECK(out == false_color_img);

}

BOOST_AUTO_TEST_SUITE_END ();

