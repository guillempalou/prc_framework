/*
 * tictoc.hpp
 *
 *  Created on: Aug 24, 2012
 *      Author: guillem
 */

#ifndef TICTOC_HPP_
#define TICTOC_HPP_

#include <map>
#include <string>
#include <sys/time.h>
#include <sys/resource.h>
#include <iostream>

namespace imageplus {
	namespace toolbox {

		class TicToc {
		public:

			inline void tic() {
				_register =  _getCPUTime();
			}

			inline double toc(bool write) {

				double a = _getCPUTime();
				double b = a - _register;

				if (write) {
					std::cerr.precision(6);
					std::cerr << "The total CPU time ellapsed is " << a - _register << " seconds " << std::endl;
				}
				return b;
			}

		private:

			inline double _getCPUTime()
			{
				double t;
				struct timeval tim,tim2;

				struct rusage ru;
				getrusage(RUSAGE_SELF, &ru);
				tim=ru.ru_stime;
				tim2=ru.ru_utime;
				t=(double)(tim.tv_sec+tim2.tv_sec)*1.0 + (double)(tim.tv_usec + tim2.tv_usec)/1000000.0;
				return t;
			}

			double _register;
		};
	}
}


#endif /* TICTOC_HPP_ */
